---
title: "Taller EDA JosueM, Joel"
author: "Josue Martinez"
date: "2025-12-04"
output:
  html_document: default
  pdf_document: default
---
```{r}
# Instalar paquetes necesarios
install.packages (" reshape2 ") # Para reestructurar datos
``` 
``` {r} 
#Cargar librerias
 library ( ggplot2 )
 library ( dplyr )
 library ( corrplot )
 library ( reshape2 )
# Mostrar numeros sin notacion cientifica
options ( scipen = 999)
``` 
``` {r}
# Importar el dataset
 # NOTA : Se debe ajustar la ruta segun la ubicacion del archivo
datos <- read.csv("~/Estadistica/Calificaciones.csv")
 # Verificar que se cargo correctamente
 cat ("El dataset tiene ", nrow ( datos ) , " filas y", ncol ( datos ) , " columnas \n")
``` 
#Numero de filas: 2000 

#Numero de columnas: 7

``` {r} 
# Ver las primeras 6 filas
 head ( datos )

 # Ver las ultimas 6 filas
tail ( datos )
``` 

``` {r} 
# Ver estructura : tipos de variables
 str ( datos )
 # Ver nombres de las columnas
 names ( datos )
``` 
# Cuantas  variables numericas existen? 
# Existen 7 variables numericas 
# Existe alguna variable de tipo texto?
#No hay variables de tipo texto 
``` {r}
 # Resumen de todas las variables
 summary ( datos )
``` 
#Minimo: 25, Maximo: 100, Mediana: 65, Media: 64.86 
``` {r}
# Ver nombres actuales
 names ( datos )

 # Renombrar las columnas
 colnames ( datos ) <- c(
 "ID", # Student_ID
 " Asistencia ", # Attendance_Rate
 " Examen_Interno_1 ", # Internal_Test_1
 " Examen_Interno_2 ", # Internal_Test_2
 " Promedio_Tareas ", # Assignment_Avg
 " Horas_Estudio ", # Study_Hours_Per_Day
 " Nota_Final " # Final_Exam_Mark
 )
 # Verificar los nuevos nombres
 names ( datos )
```
```{r}
# Contar valores NA en cada columna
 colSums ( is.na ( datos ) )

 # Total de valores faltantes
 cat (" Total de valores faltantes :", sum( is.na ( datos ) ) , "\n")
``` 
#No hay valores faltantes 
``` {r}
# MEDIA (promedio),
 media <- mean ( datos$` Nota_Final ` )
 cat (" Media :", round ( media , 2) , "\n")

 # MEDIANA ( valor central )
 mediana <- median(datos$` Nota_Final `)
cat("Mediana:", round(mediana, 2), "\n")

 # MODA ( valor mas frecuente )
# Se crea una tabla de frecuencias y se busca el maximo
tabla_freq <- table ( round ( datos$` Nota_Final ` , 0) )
 moda <- as.numeric ( names ( tabla_freq ) [ which.max ( tabla_freq ) ])
 cat (" Moda :", moda , "\n")
``` 
#La media es de 64.86, la mediana es de 65 y la moda es de 66 

``` {r}
# VARIANZA
varianza <- var( datos$` Nota_Final ` )
 cat (" Varianza :", round ( varianza , 2) , "\n")
 # DESVIACION ESTANDAR
 desv_est <- sd( datos$` Nota_Final `)
 cat (" Desviacion Estandar :", round ( desv_est , 2) , "\n")

 # CUARTILES
 cuartiles <- quantile ( datos$` Nota_Final ` , probs = c (0.25 , 0.50 , 0.75) )
 cat ("Q1 (25%) :", round ( cuartiles [1] , 2) , "\n")
 cat ("Q2 (50%) :", round ( cuartiles [2] , 2) , "\n")
 cat ("Q3 (75%) :", round ( cuartiles [3] , 2) , "\n")
 # RANGO
 rango <- max ( datos$` Nota_Final ` ) - min ( datos$` Nota_Final ` )
 cat (" Rango :", round ( rango , 2) , "\n")
```
#Varianza: 128.62, Desviacion estandar: 11.34, Q1: 58, # Q2: 65, Q3: 73 , Rango: 75  
```{r}
# Crear categorias de rendimiento
 datos$Rendimiento <- cut ( datos$` Nota_Final `,breaks = c(0 , 60 , 70 , 80 , 90 , 100) ,
 labels = c(" Reprobado ", " Suficiente ", " Bueno ", "Muy Bueno ",
" Excelente ") ,
 include.lowest = TRUE
 )

 # Contar estudiantes por categoria
 frecuencias <- table ( datos$Rendimiento) 
 porcentajes <- round ( prop.table ( frecuencias ) * 100 , 1)

 # Crear etiquetas con porcentajes
 etiquetas <- paste ( names ( frecuencias ) , "\n", porcentajes , "%", sep = "")

 # Definir colores
 colores <- c("#FF6B6B", 
              "#FFA94D", 
              "#FFD93D", 
              "#B6CB77", 
              "#4D96FF")

 # Crear grafico de pastel
 
 frecuencias
pie (frecuencias,
     labels = etiquetas,
     col = colores,
     main = "Distribucion de rendimiento academico")
``` 
# Categoria mas frecuente: Suficiente, Porcentaje de reprobados: 33.8% 
```{r} 
# Crear categorias de asistencia
 datos$Nivel_Asistencia <- cut ( datos$` Asistencia ` ,
 breaks = c(0 , 60 , 75 , 90 , 100) ,
 labels = c(" Bajo ", " Regular ", " Bueno ", " Excelente ") ,
 include.lowest = TRUE
 )

 # Contar frecuencias
 freq_asistencia <- table ( datos$Nivel_Asistencia )

 # Grafico de barras horizontales
 barplot ( freq_asistencia ,
 horiz = TRUE ,
 col = c("#FF6B6B", "#FFA94D", "#6BCB77", "#4D96FF") ,
 main = " Estudiantes por Nivel de Asistencia ",
 xlab = " Numero de Estudiantes ",
 ylab = " Nivel de Asistencia ",
 las = 1)
```
#Estudiantes con asistencia excelente: 450, Nivel con menos estudiantes: Bajo 


```{r}
# Crear diagrama de cajas para ambos examenes internos
boxplot ( datos$` Examen_Interno_1 ` , datos$` Examen_Interno_2 ` ,
names = c(" Examen Interno 1", " Examen Interno 2") ,
col = c("#4D96FF", "#6BCB77") ,
main = " Comparacion de Examenes Internos ",
ylab = " Calificacion (0 -100) ",
border = " darkblue ")

# Agregar linea de la media 
abline ( h = mean ( datos$` Examen_Interno_1 ` ) , col = "red ", lty = 2)
```

```{r}
# Estadisticas del Examen Interno 1
cat ("=== EXAMEN INTERNO 1 ===\ n")
cat (" Media :", round ( mean ( datos$` Examen_Interno_1 ` ) , 2) , "\n")
cat (" Mediana :", round ( median ( datos$` Examen_Interno_1 ` ) , 2) , "\n")
cat (" Desv . Est .:", round (sd( datos$` Examen_Interno_1 ` ) , 2) , "\n\n")

# Estadisticas del Examen Interno 2
cat ("=== EXAMEN INTERNO 2 ===\ n")
cat (" Media :", round ( mean ( datos$` Examen_Interno_2 ` ) , 2) , "\n")
cat (" Mediana :", round ( median ( datos$` Examen_Interno_2 ` ) , 2) , "\n")
cat (" Desv . Est .:", round (sd( datos$` Examen_Interno_2 ` ) , 2) , "\n")
```
#¿Cual examen tiene la mediana mas alta??
#Examen interno 2
#Cual examen tiene mayor dispersion (desviacion estndar)?
#Examen interno 1
#¿Se observan valores at´ıpicos en alguno de los examenes?
#En ambos examenes

```{r}
# Crear grafico de violin
ggplot ( datos , aes ( x = Nivel_Asistencia , y = datos$` Nota_Final ` ,
fill = Nivel_Asistencia ) ) +
geom_violin ( trim = FALSE , alpha = 0.7) +
geom_boxplot ( width = 0.15 , fill = "white") +
scale_fill_manual ( values = c("#FF6B6B", "#FFA94D",
"#6BCB77", "#4D96FF") ) +
labs (
title = " Distribucion de Nota Final por Nivel de Asistencia ",
 x = " Nivel de Asistencia ",
 y = " Nota del Examen Final "
) +
theme_minimal () +
theme ( legend.position = " none ")
```
#Nivel con notas mas altas: Excelente. Diferencias en la distribuciones: algunos son mas anchos que otros 
``` {r} 
hist(datos$` Nota_Final `,
     breaks = 20,
     col = "#4D96FF",
     border = "white",
     main = "Histograma de Nota Final",
     xlab = "Nota del Examen Final",
     ylab = "Densidad",
     freq =    FALSE)

 # Agregar curva normal teorica
curve(dnorm(x,
            mean = mean(datos$Nota_Final),
            sd = sd(datos$Nota_Final)),
      add = TRUE,
      col = "red",
      lwd = 2)

# Leyenda
legend("topright",
       legend = "Curva Normal",
       col = "red",
       lwd = 2)
``` 
# Tiene forma de campana: Si, Es sesgada 
``` {r}
qqnorm(datos$` Nota_Final ` ,
main = "Grafico Q-Q: Nota Final",
xlab = "Cuantiles Teoricos",
ylab = "Cuantiles de los Datos",
col = "#4D96FF",
pch = 19,
cex = 0.6)

qqline(datos$ , col = "red", lwd = 2)
``` 
#Los puntos siguen la linea roja: Si, Existen desviaciones en los extremos?: Si 
``` {r}
shapiro_test <- shapiro.test(datos$` Nota_Final `)

cat("=== PRUEBA DE SHAPIRO -WILK ===\n")
cat("Estadistico W:", round(shapiro_test$statistic , 4), "\n")
cat("Valor p:", shapiro_test$p.value , "\n")

if(shapiro_test$p.value > 0.05) {
cat("Conclusion: Los datos SON NORMALES (p > 0.05)\n")
} else {
cat("Conclusion: Los datos NO SON NORMALES (p <= 0.05)\n")
}
``` 
#Valor p: 0.00021. Conclucion: Los datos no son normales 
``` {r}
datos_std <- (datos$` Nota_Final ` - mean(datos$` Nota_Final `)) / sd(datos$` Nota_Final `)
ks_test <- ks.test(datos_std, "pnorm")

cat("=== PRUEBA DE KOLMOGOROV -SMIRNOV ===\n")
cat("Estadistico D:", round(ks_test$statistic , 4), "\n")
cat("Valor p:", ks_test$p.value , "\n")

if(ks_test$p.value > 0.05) {
cat("Conclusion: Los datos SON NORMALES (p > 0.05)\n")
} else {
cat("Conclusion: Los datos NO SON NORMALES (p <= 0.05)\n")
}
```
#Valor p: 0.0695, Conclucion: Los datos son normales 
``` {r}
vars_numericas <- datos [ , c(" Asistencia ", " Examen_Interno_1 ",
 " Examen_Interno_2 ", " Promedio_Tareas ",
 " Horas_Estudio ", " Nota_Final ") ]

matriz_cor <- cor(vars_numericas)
round(matriz_cor , 2)

heatmap(matriz_cor ,
col = colorRampPalette(c("#4D96FF", "white", "#FF6B6B"))(20),
symm = TRUE ,
main = "Mapa de Calor - Correlaciones")

matriz_largo <- melt(matriz_cor)
colnames(matriz_largo) <- c("Variable1", "Variable2", "Correlacion")

ggplot(matriz_largo , aes(x = Variable1 , y = Variable2 , fill = Correlacion)) +
geom_tile(color = "white") +
geom_text(aes(label = round(Correlacion , 2)), size = 3) +
scale_fill_gradient2(low = "#4D96FF", mid = "white", high = "#FF6B6B",
midpoint = 0, limit = c(-1, 1)) +
labs(title = "Mapa de Calor - Matriz de Correlaciones",
x = "", y = "") +
theme_minimal () +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
``` 
#Examen interno 1 con horas de estudio, promedio tareas con horas de estudio,examen interno 2 con horas de estudio, examen interno 1 con examen interno 2 
#Si 
# Horas de estudio 
```{r}
# Crear grafico de violin
ggplot ( datos , aes ( x = datos$Nivel_Asistencia , y = datos$` Nota_Final `,
 fill = datos$Nivel_Asistencia ) ) +
geom_violin ( trim = FALSE , alpha = 0.7) +
 geom_boxplot ( width = 0.15 , fill = " white ") +
 scale_fill_manual ( values = c("#FF6B6B", "#FFA94D", "#6BCB77",
"#4D96FF") ) +
labs ( title = " Distribucion de Nota Final por Nivel de Asistencia ",
x = " Nivel de Asistencia ",
 y = " Nota del Examen Final ") +
theme_minimal () +
 theme ( legend.position = " none ")
# Grafico de violin por categoria de rendimiento
 ggplot ( datos , aes ( x = datos$Rendimiento , y = datos$` Examen_Interno_1 ` ,
fill = Rendimiento ) ) +
 geom_violin ( trim = FALSE , alpha = 0.7) +
 geom_boxplot ( width = 0.1 , fill = "white") +
 scale_fill_manual ( values = c("#FF6B6B", "#FFA94D", "#FFD93D",
 "#6BCB77", "#4D96FF") ) +
 labs ( title = " Distribucion de Examen Interno 1 por Rendimiento Final ",
 x = " Categoria de Rendimiento ",
 y = " Nota Examen Interno 1") +
 theme_minimal () +
 theme ( legend.position = " none ",
 axis.text.x = element_text ( angle = 45 , hjust = 1) )
``` 
#Nivel con distribucion mas concentrada: bajo, Nivel con notas mas altas: Excelente, Conclucion: ah mayor asistencia mejor rendimiento
``` {r}
# Seleccionar solo variables numéricas
vars_numericas <- datos [ , c(" Asistencia ", " Examen_Interno_1 ",
 " Examen_Interno_2 ", " Promedio_Tareas ",
 " Horas_Estudio ", " Nota_Final ") ]

# Calcular matriz de correlación
matriz_cor <- cor(vars_numericas)

# Mostrar la matriz redondeada
round(matriz_cor, 2)
# Mapa de calor con corrplot
library(corrplot)
corrplot(
  matriz_cor,
  method = "color",
  type = "upper",
  addCoef.col = "black",
  number.cex = 0.7,
  tl.col = "black",
  tl.srt = 45,
  col = colorRampPalette(c("#FF6B6B", "white", "#4D96FF"))(100),
  title = "Mapa de Calor - Correlaciones",
  mar = c(0, 0, 2, 0)
)
# Convertir matriz a formato largo
 matriz_largo <- melt ( matriz_cor )
 colnames ( matriz_largo ) <- c(" Variable1 ", " Variable2 ", " Correlacion ")

 # Crear heatmap con ggplot2
 ggplot ( matriz_largo , aes ( x = Variable1 , y = Variable2 ,
 fill = Correlacion ) ) +
 geom_tile ( color = "white") +
 geom_text (aes( label = round ( Correlacion , 2) ) , size = 3) +
 scale_fill_gradient2 ( low = "#FF6B6B", mid = "white",
 high = "#4D96FF", midpoint = 0) +
 labs ( title = " Matriz de Correlacion ") +
 theme_minimal () +
 theme ( axis . text . x = element_text ( angle = 45 , hjust = 1) )
``` 
#Nota final con asistencia, examen interno 1 con examen interno 2, nota final con promedio tareas, no, asistencia 
``` {r}
# Crear gráfico de dispersión
plot(
  datos$` Asistencia `, datos$` Nota_Final `,
  main = "Relación entre Asistencia y Nota Final",
  xlab = "Porcentaje de Asistencia",
  ylab = "Nota del Examen Final",
  col = "#4D96FF",
  pch = 19,
  cex = 0.7
)

# Agregar línea de tendencia (regresión lineal)
abline(
  lm(datos$` Nota_Final ` ~ datos$` Asistencia `, data = datos),
  col = "red",
  lwd = 2
)

# Calcular correlación de Pearson
correlacion <- cor(datos$` Asistencia `, datos$` Nota_Final `)
cat("Coeficiente de correlación (r):", round(correlacion, 4), "\n")

# Prueba de significancia
prueba_cor <- cor.test(datos$` Asistencia `, datos$` Nota_Final `)
cat("Valor p:", prueba_cor$p.value, "\n")

# Interpretación de significancia
if (prueba_cor$p.value < 0.05) {
  cat("La correlación ES estadísticamente significativa\n")
} else {
  cat("La correlación NO es significativa\n")
}
``` 
``` {r}
1 # Calcular correlacion de Pearson
 correlacion <- cor( datos$` Asistencia ` , datos$` Nota_Final ` )
cat (" Coeficiente de correlacion (r):", round ( correlacion , 4) , "\n")

 # Prueba de significancia
 prueba_cor <- cor.test ( datos$` Asistencia ` , datos$` Nota_Final ` )
 cat (" Valor p:", prueba_cor$p.value , "\n")

# Interpretar
 if( prueba_cor$p.value < 0.05) {
 cat ("La correlacion ES estadisticamente significativa \n")
 } else {
 cat ("La correlacion NO es significativa \n")
 }
``` 
```{r}
 # Crear el modelo de regresion
 modelo <- lm( datos$` Nota_Final ` ~ datos$` Asistencia ` , data = datos )
 # Ver resumen del modelo
 summary ( modelo )
# Obtener coeficientes
 intercepto <- coef ( modelo ) [1]
 pendiente <- coef ( modelo ) [2]

 cat ("=== ECUACION DEL MODELO ===\ n")
 cat (" Nota_Final =", round ( intercepto , 2) , "+",
 round ( pendiente , 2) , "* Asistencia \n\n")

r_cuadrado <- summary(modelo)$r.squared

cat("R cuadrado (R^2):", round(r_cuadrado, 4), "\n")

cat(
  "Esto significa que la Asistencia explica el",
  round(r_cuadrado * 100, 1), 
  "% de la variabilidad en la Nota Final\n"
)
``` 
``` {r}
 # Grafico con ggplot2
# Gráfico de regresión lineal con ggplot
ggplot(datos, aes(x = datos$` Asistencia `, y = datos$` Nota_Final `)) +
  geom_point(color = "#4D96FF", alpha = 0.5) +
  geom_smooth(method = "lm", color = "red", se = TRUE) +
  labs(
    title = "Regresión Lineal: Nota Final vs Asistencia",
    subtitle = paste("R^2 =", round(r_cuadrado, 4)),
    x = "Porcentaje de Asistencia",
    y = "Nota del Examen Final"
  ) +
  theme_minimal()


# Crear datos para predicción
nuevos_datos <- data.frame(
  Asistencia = c(60, 70, 80, 90, 100)
)

# Realizar predicciones
predicciones <- predict(modelo, newdata = nuevos_datos)

# Mostrar resultados
cat("=== PREDICCIONES ===\n")
for (i in 1:5) {
  cat(
    "Si la asistencia es", nuevos_datos$Asistencia[i], 
    "% -> Nota predicha:", round(predicciones[i], 1), "\n"
  )
}
```